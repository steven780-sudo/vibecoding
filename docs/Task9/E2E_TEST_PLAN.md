# Chronos MVP 端到端测试计划

## 测试环境

- **操作系统**: macOS
- **Python版本**: 3.10+
- **Node.js版本**: 18+
- **浏览器**: Chrome/Safari

## 测试前准备

1. 运行 `./setup.sh` 确保环境配置正确
2. 运行 `./start-dev.sh` 启动开发环境
3. 访问 http://localhost:5173

## 测试流程 1: 完整的初始化→快照→历史→回滚流程

### 1.1 初始化仓库

**步骤**:
1. 打开应用，看到欢迎页面
2. 点击"打开仓库"按钮
3. 输入测试路径（如：`/tmp/chronos-test-repo`）
4. 点击"初始化新仓库"

**预期结果**:
- ✅ 显示成功消息
- ✅ 进入主工作区
- ✅ 显示仓库状态（main分支，0个变更）

**实际结果**: _待测试_

### 1.2 创建测试文件

**步骤**:
1. 在仓库目录创建测试文件：
   ```bash
   echo "Hello World" > /tmp/chronos-test-repo/test1.txt
   echo "Test File 2" > /tmp/chronos-test-repo/test2.txt
   ```
2. 点击"刷新"按钮

**预期结果**:
- ✅ 仓库状态显示"2个变更文件"
- ✅ "创建快照"按钮可用

**实际结果**: _待测试_

### 1.3 创建快照

**步骤**:
1. 点击"创建快照"按钮
2. 查看变更文件列表（应显示test1.txt和test2.txt）
3. 确认两个文件都被选中
4. 输入描述："初始提交"
5. 点击"确认创建"

**预期结果**:
- ✅ 显示"快照创建成功"消息
- ✅ 对话框关闭
- ✅ 仓库状态更新为"0个变更文件"
- ✅ 历史记录显示新的提交

**实际结果**: _待测试_

### 1.4 修改文件并创建第二个快照

**步骤**:
1. 修改文件：
   ```bash
   echo "Modified content" > /tmp/chronos-test-repo/test1.txt
   echo "New file" > /tmp/chronos-test-repo/test3.txt
   ```
2. 刷新状态
3. 创建快照，描述："第二次提交"

**预期结果**:
- ✅ 显示2个变更文件（1个修改，1个新增）
- ✅ 快照创建成功
- ✅ 历史记录显示2个提交

**实际结果**: _待测试_

### 1.5 查看历史记录

**步骤**:
1. 查看右侧历史记录面板
2. 验证显示2个提交
3. 最新提交标记为"最新"

**预期结果**:
- ✅ 时间线正确显示
- ✅ 提交信息正确
- ✅ 提交ID显示（前8位）
- ✅ 每个提交有"回滚到此版本"按钮

**实际结果**: _待测试_

### 1.6 回滚到第一个版本

**步骤**:
1. 点击第一个提交的"回滚到此版本"按钮
2. 在确认对话框中查看警告信息
3. 点击"确认回滚"

**预期结果**:
- ✅ 显示确认对话框，包含提交详情和警告
- ✅ 显示"回滚成功"消息
- ✅ 文件内容恢复到第一个版本
- ✅ test3.txt不存在
- ✅ test1.txt内容为"Hello World"

**实际结果**: _待测试_

**验证命令**:
```bash
cat /tmp/chronos-test-repo/test1.txt  # 应显示 "Hello World"
ls /tmp/chronos-test-repo/test3.txt   # 应不存在
```

## 测试流程 2: 分支创建→切换→合并流程

### 2.1 创建新分支

**步骤**:
1. 在左侧分支管理面板点击"创建新分支"
2. 输入分支名："feature-test"
3. 点击"创建"

**预期结果**:
- ✅ 显示"分支创建成功"消息
- ✅ 分支列表包含"feature-test"
- ✅ 当前分支仍为"main"

**实际结果**: _待测试_

### 2.2 切换到新分支

**步骤**:
1. 在分支下拉框选择"feature-test"
2. 在确认对话框点击"确认切换"

**预期结果**:
- ✅ 显示切换确认对话框
- ✅ 显示"已切换到分支 feature-test"消息
- ✅ 当前分支标签显示"feature-test"

**实际结果**: _待测试_

### 2.3 在新分支创建提交

**步骤**:
1. 创建新文件：
   ```bash
   echo "Feature file" > /tmp/chronos-test-repo/feature.txt
   ```
2. 刷新并创建快照，描述："添加功能文件"

**预期结果**:
- ✅ 快照创建成功
- ✅ 历史记录显示新提交
- ✅ 当前分支为"feature-test"

**实际结果**: _待测试_

### 2.4 切换回主分支

**步骤**:
1. 切换到"main"分支
2. 确认切换

**预期结果**:
- ✅ 切换成功
- ✅ feature.txt文件不存在（在main分支）

**实际结果**: _待测试_

**验证命令**:
```bash
ls /tmp/chronos-test-repo/feature.txt  # 应不存在
```

### 2.5 合并分支

**步骤**:
1. 切换到"main"分支（如果不在）
2. 切换到"feature-test"分支
3. 点击"合并到主版本"按钮
4. 在合并预览对话框点击"确认合并"

**预期结果**:
- ✅ 显示合并预览对话框
- ✅ 显示源分支和目标分支
- ✅ 显示"分支合并成功"消息
- ✅ 切换到main分支后，feature.txt存在

**实际结果**: _待测试_

**验证命令**:
```bash
# 切换到main分支后
ls /tmp/chronos-test-repo/feature.txt  # 应存在
```

## 测试流程 3: 错误处理和边界情况

### 3.1 空描述验证

**步骤**:
1. 创建变更文件
2. 打开快照对话框
3. 不输入描述，直接点击"确认创建"

**预期结果**:
- ✅ 显示"请输入快照描述"错误消息
- ✅ 对话框不关闭
- ✅ 快照未创建

**实际结果**: _待测试_

### 3.2 未选择文件验证

**步骤**:
1. 打开快照对话框
2. 取消所有文件选择
3. 输入描述，点击"确认创建"

**预期结果**:
- ✅ 显示"请至少选择一个文件"错误消息
- ✅ 快照未创建

**实际结果**: _待测试_

### 3.3 无效分支名验证

**步骤**:
1. 点击"创建新分支"
2. 输入包含空格的分支名："invalid branch"
3. 点击"创建"

**预期结果**:
- ✅ 显示"分支名称只能包含字母、数字、下划线和连字符"错误
- ✅ 分支未创建

**实际结果**: _待测试_

### 3.4 重复分支名验证

**步骤**:
1. 尝试创建已存在的分支名（如"main"）

**预期结果**:
- ✅ 显示"分支已存在"错误
- ✅ 分支未创建

**实际结果**: _待测试_

## 测试流程 4: UI响应性测试

### 4.1 加载状态测试

**步骤**:
1. 执行各种操作，观察loading状态

**预期结果**:
- ✅ 所有异步操作显示loading状态
- ✅ 按钮显示loading图标
- ✅ 卡片显示骨架屏
- ✅ 操作完成后loading消失

**实际结果**: _待测试_

### 4.2 刷新功能测试

**步骤**:
1. 点击顶部"刷新"按钮
2. 观察所有数据更新

**预期结果**:
- ✅ 仓库状态刷新
- ✅ 历史记录刷新
- ✅ 分支列表刷新
- ✅ 显示全局loading状态

**实际结果**: _待测试_

## 测试总结

### 通过的测试
- [ ] 1.1 初始化仓库
- [ ] 1.2 创建测试文件
- [ ] 1.3 创建快照
- [ ] 1.4 修改文件并创建第二个快照
- [ ] 1.5 查看历史记录
- [ ] 1.6 回滚到第一个版本
- [ ] 2.1 创建新分支
- [ ] 2.2 切换到新分支
- [ ] 2.3 在新分支创建提交
- [ ] 2.4 切换回主分支
- [ ] 2.5 合并分支
- [ ] 3.1 空描述验证
- [ ] 3.2 未选择文件验证
- [ ] 3.3 无效分支名验证
- [ ] 3.4 重复分支名验证
- [ ] 4.1 加载状态测试
- [ ] 4.2 刷新功能测试

### 发现的问题
_待记录_

### 优化建议
_待记录_

## 清理

测试完成后清理测试数据：
```bash
rm -rf /tmp/chronos-test-repo
```
