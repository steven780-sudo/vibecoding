# Chronos v2.0 优化计划

**基于 v1.2 版本功能对比**  
**创建日期**: 2025-11-02  
**状态**: 待实施

---

## 📊 功能对比总览

| 功能模块 | v1.2 状态 | v2.0 状态 | 优先级 | 备注 |
|---------|----------|----------|--------|------|
| 首页 - 最近使用记录 | ✅ 完整 | ❌ 缺失 | P0 | 需要实现 |
| 首页 - 历史记录删除 | ✅ 完整 | ❌ 缺失 | P1 | 需要实现 |
| 主页 - 文件树状展示 | ✅ 完整 | ⚠️ 简化 | P0 | 需要优化 |
| 主页 - 文件状态标识 | ✅ 完整 | ⚠️ 简化 | P1 | 需要优化 |
| 主页 - 已追踪文件列表 | ✅ 完整 | ❌ 缺失 | P1 | 需要实现 |
| 历史记录 - 展开详情 | ✅ 完整 | ❌ 缺失 | P0 | 需要实现 |
| 历史记录 - 文件变更列表 | ✅ 完整 | ❌ 缺失 | P0 | 需要实现 |
| 历史记录 - 收起详情按钮 | ✅ 完整 | ❌ 缺失 | P1 | 需要实现 |
| Git ID 显示优化 | ✅ 完整 | ❌ 缺失 | P2 | 需要实现 |
| 软件更新说明 | ✅ 完整 | ❌ 缺失 | P1 | 需要实现 |
| 使用说明抽屉 | ✅ 完整 | ❌ 缺失 | P1 | 需要实现 |
| 版权信息 | ✅ 完整 | ❌ 缺失 | P2 | 需要实现 |

---

## 🎯 详细优化需求

### P0 - 关键功能（必须实现）

#### 1. 首页 - 最近使用的时光机文件夹

**v1.2 功能**:
- 显示最近打开的仓库列表
- 点击可直接进入
- 显示完整路径
- 有删除按钮（垃圾桶图标）

**v2.0 现状**: 完全缺失

**实现要求**:
- [ ] 在首页显示"最近使用的时光机文件夹"区域
- [ ] 显示最近 10 个打开的仓库
- [ ] 每个记录显示完整路径
- [ ] 点击记录可直接打开仓库
- [ ] 每个记录右侧有删除按钮
- [ ] 删除时需要确认
- [ ] 自动检测路径是否存在，无效路径自动删除或标记

**技术实现**:
- 使用 DatabaseService 存储历史记录
- 在 HomePage 组件中展示
- 添加路径验证逻辑

---

#### 2. 文件树状展示优化

**v1.2 功能**:
- 完整的树状结构
- 文件夹可展开/折叠
- 默认折叠状态
- 清晰的层级缩进
- 文件夹和文件图标区分

**v2.0 现状**: 有基础实现，但需要优化

**实现要求**:
- [ ] 优化文件树的视觉层级
- [ ] 添加展开/折叠动画
- [ ] 默认折叠所有文件夹
- [ ] 优化文件夹和文件的图标
- [ ] 添加文件数量统计

**技术实现**:
- 优化 FileTree 组件
- 使用 Ant Design Tree 组件
- 添加状态管理

---

#### 3. 历史记录 - 展开查看详情

**v1.2 功能**:
- 点击历史记录可展开详情
- 显示完整的提交消息
- 显示变更文件列表
- 显示文件路径（带删除线表示删除）
- 有"收起详情"按钮

**v2.0 现状**: 完全缺失

**实现要求**:
- [ ] 历史记录卡片可点击展开
- [ ] 展开后显示完整提交消息
- [ ] 显示变更文件列表
- [ ] 文件列表显示完整路径
- [ ] 删除的文件用删除线标识
- [ ] 添加"收起详情"按钮
- [ ] 展开/收起有动画效果

**技术实现**:
- 修改 HistoryViewer 组件
- 添加展开/收起状态
- 从 Git Service 获取文件变更详情
- 使用 Ant Design Collapse 或自定义实现

---

#### 4. 文件变更列表显示

**v1.2 功能**:
- 左侧显示"已追踪的文件"列表
- 显示删除的文件（带删除线）
- 文件按路径分组显示

**v2.0 现状**: 只显示文件数量，不显示详细列表

**实现要求**:
- [ ] 在左侧文件区域显示"已追踪的文件"
- [ ] 列出所有被删除的文件
- [ ] 删除的文件用删除线标识
- [ ] 文件按文件夹分组
- [ ] 显示文件数量统计

**技术实现**:
- 修改 RepositoryPage 左侧布局
- 从 Git Service 获取已追踪文件
- 添加文件分组逻辑

---

### P1 - 重要功能（应该实现）

#### 5. 软件更新说明抽屉

**v1.2 功能**:
- 右侧抽屉展示
- 显示版本号和日期
- 分类显示更新内容：
  - 核心功能
  - 用户友好交互
  - 界面优化
  - 技术改进
- 支持多个版本历史

**v2.0 现状**: 完全缺失

**实现要求**:
- [ ] 添加"软件更新说明"按钮
- [ ] 点击打开右侧抽屉
- [ ] 显示版本更新历史
- [ ] 分类展示更新内容
- [ ] 使用 Markdown 格式
- [ ] 支持版本号和日期

**技术实现**:
- 创建 UpdateLogDrawer 组件
- 使用 Ant Design Drawer
- 创建更新日志 Markdown 文件
- 添加版本管理

---

#### 6. 使用说明抽屉

**v1.2 功能**:
- 右侧抽屉展示
- 显示核心用法步骤
- 显示功能按钮说明
- 显示联系方式
- 图标 + 文字说明

**v2.0 现状**: 完全缺失

**实现要求**:
- [ ] 添加"使用说明"按钮
- [ ] 点击打开右侧抽屉
- [ ] 显示核心用法（4步）
- [ ] 显示功能按钮说明
- [ ] 显示联系方式
- [ ] 使用图标增强可读性

**技术实现**:
- 创建 HelpDrawer 组件
- 使用 Ant Design Drawer
- 添加图标和样式

---

#### 7. 文件状态标识优化

**v1.2 功能**:
- 新增文件：绿色圆点 + [新增]
- 修改文件：黄色圆点 + [修改]
- 删除文件：红色圆点 + [删除]
- 清晰的视觉区分

**v2.0 现状**: 有基础实现，但不够明显

**实现要求**:
- [ ] 优化文件状态图标
- [ ] 使用彩色圆点标识
- [ ] 添加文字标签
- [ ] 统一颜色规范：
  - 新增：绿色
  - 修改：黄色
  - 删除：红色

**技术实现**:
- 修改 FileTree 组件
- 添加状态图标组件
- 统一颜色常量

---

#### 8. 历史记录删除功能

**v1.2 功能**:
- 首页历史记录可删除
- 点击垃圾桶图标删除
- 删除前需要确认

**v2.0 现状**: 完全缺失

**实现要求**:
- [ ] 首页历史记录添加删除按钮
- [ ] 点击删除时弹出确认对话框
- [ ] 删除后更新列表
- [ ] 删除后从数据库移除

**技术实现**:
- 修改 HomePage 组件
- 添加删除功能
- 使用 Modal.confirm

---

### P2 - 优化功能（可选实现）

#### 9. Git ID 显示优化

**v1.2 功能**:
- 使用身份证图标
- 显示"ID:"标识
- 更直观的视觉效果

**v2.0 现状**: 只显示短 ID，没有图标

**实现要求**:
- [ ] 添加身份证图标
- [ ] 添加"ID:"文字标识
- [ ] 优化视觉样式

**技术实现**:
- 修改 HistoryViewer 组件
- 添加图标
- 优化样式

---

#### 10. 版权信息

**v1.2 功能**:
- 首页右上角显示"Copyright © sunshunda"
- 简洁优雅

**v2.0 现状**: 完全缺失

**实现要求**:
- [ ] 首页右上角添加版权信息
- [ ] 使用灰色文字
- [ ] 字体大小适中

**技术实现**:
- 修改 HomePage 组件
- 添加版权文字
- 优化样式

---

## 📋 实施计划

### 第一阶段：关键功能（1-2 天）

1. **首页最近使用记录** (4 小时)
   - 数据库存储
   - UI 展示
   - 删除功能

2. **文件树状展示优化** (3 小时)
   - 优化组件
   - 添加动画
   - 优化样式

3. **历史记录展开详情** (4 小时)
   - 展开/收起功能
   - 文件变更列表
   - 样式优化

4. **文件变更列表** (3 小时)
   - 已追踪文件显示
   - 删除文件标识
   - 分组逻辑

### 第二阶段：重要功能（1 天）

5. **软件更新说明** (2 小时)
   - 创建组件
   - 编写更新日志
   - 集成到页面

6. **使用说明** (2 小时)
   - 创建组件
   - 编写说明内容
   - 集成到页面

7. **文件状态标识** (2 小时)
   - 优化图标
   - 统一颜色
   - 优化样式

8. **历史记录删除** (1 小时)
   - 添加删除按钮
   - 确认对话框
   - 数据库操作

### 第三阶段：优化功能（0.5 天）

9. **Git ID 优化** (1 小时)
   - 添加图标
   - 优化样式

10. **版权信息** (0.5 小时)
    - 添加文字
    - 优化样式

---

## 🎨 UI/UX 改进建议

### 颜色规范

- **新增**: `#52c41a` (绿色)
- **修改**: `#faad14` (黄色)
- **删除**: `#ff4d4f` (红色)
- **主色**: `#1890ff` (蓝色)
- **成功**: `#52c41a` (绿色)
- **警告**: `#faad14` (黄色)
- **错误**: `#ff4d4f` (红色)

### 图标规范

- **文件夹**: `FolderOutlined` / `FolderOpenOutlined`
- **文件**: `FileOutlined`
- **新增**: `PlusCircleFilled` (绿色)
- **修改**: `EditFilled` (黄色)
- **删除**: `MinusCircleFilled` (红色)
- **Git ID**: `IdcardOutlined`
- **时间**: `ClockCircleOutlined`
- **用户**: `UserOutlined`

### 间距规范

- **小间距**: 8px
- **中间距**: 16px
- **大间距**: 24px
- **卡片内边距**: 16px
- **页面内边距**: 20px

---

## 📝 技术实现细节

### 1. 最近使用记录

```typescript
// DatabaseService 添加方法
interface RecentRepository {
  id: string
  path: string
  name: string
  lastOpened: Date
}

class DatabaseService {
  getRecentRepositories(limit: number = 10): RecentRepository[]
  removeRecentRepository(path: string): void
  validateRepositoryPath(path: string): boolean
}
```

### 2. 历史记录展开详情

```typescript
// HistoryViewer 组件状态
interface HistoryViewerState {
  expandedIds: Set<string>
}

// 获取文件变更详情
interface FileChangeDetail {
  path: string
  status: 'added' | 'modified' | 'deleted'
  oldPath?: string
}

async function getCommitFiles(commitId: string): Promise<FileChangeDetail[]>
```

### 3. 抽屉组件

```typescript
// UpdateLogDrawer
interface UpdateLog {
  version: string
  date: string
  features: string[]
  improvements: string[]
  fixes: string[]
}

// HelpDrawer
interface HelpContent {
  steps: string[]
  features: Array<{ icon: string; title: string; description: string }>
  contact: string
}
```

---

## ✅ 验收标准

### 功能验收

- [ ] 所有 P0 功能完整实现
- [ ] 所有 P1 功能完整实现
- [ ] UI 与 v1.2 保持一致性
- [ ] 所有功能通过手动测试
- [ ] 无明显 Bug

### 性能验收

- [ ] 页面加载时间 < 1s
- [ ] 文件树展开/收起流畅
- [ ] 历史记录展开/收起流畅
- [ ] 无明显卡顿

### 代码质量

- [ ] TypeScript 类型检查通过
- [ ] ESLint 检查通过
- [ ] 代码有适当注释
- [ ] 组件结构清晰

---

## 📊 进度跟踪

| 功能 | 状态 | 完成日期 | 备注 |
|-----|------|---------|------|
| 首页最近使用记录 | ✅ 已完成 | 2025-11-02 | 包含删除功能 |
| 文件树状展示优化 | ✅ 已完成 | 2025-11-02 | 支持展开/折叠 |
| 历史记录展开详情 | ✅ 已完成 | 2025-11-02 | 支持展开/收起 |
| 文件变更列表 | ⚠️ 部分完成 | 2025-11-02 | 文件树已显示 |
| 软件更新说明 | ✅ 已完成 | 2025-11-02 | 右侧抽屉 |
| 使用说明 | ✅ 已完成 | 2025-11-02 | 右侧抽屉 |
| 文件状态标识 | ✅ 已完成 | 2025-11-02 | 彩色圆点+标签 |
| 历史记录删除 | ✅ 已完成 | 2025-11-02 | 首页删除按钮 |
| Git ID 优化 | ✅ 已完成 | 2025-11-02 | 添加身份证图标 |
| 版权信息 | ✅ 已完成 | 2025-11-02 | 首页右上角 |

---

**文档版本**: 1.0  
**最后更新**: 2025-11-02  
**负责人**: Kiro AI + sunshunda
